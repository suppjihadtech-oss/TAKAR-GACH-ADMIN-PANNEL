<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin V12</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body{background:#f0fdf4;font-family:sans-serif;margin:0;padding:20px;color:#333}
        .card{background:white;padding:15px;border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,0.05);margin-bottom:15px}
        .inp{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ddd;border-radius:5px;box-sizing:border-box}
        .btn{padding:10px 20px;background:#059669;color:white;border:none;border-radius:5px;cursor:pointer;width:100%}
        .row{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #eee;padding:10px 0}
        select.inp{background:white}
    </style>
</head>
<body>
    <div id="login">
        <div class="card" style="max-width:300px;margin:100px auto;text-align:center">
            <h2 style="color:#059669">Admin V12</h2>
            <input id="u" class="inp" placeholder="Username">
            <input id="p" type="password" class="inp" placeholder="Password">
            <button class="btn" onclick="auth()">Login</button>
        </div>
    </div>

    <div id="panel" style="display:none">
        <div class="card" style="display:flex;justify-content:space-between">
            <div style="text-align:center"><h3>Users</h3><h2 id="st-users">0</h2></div>
            <div style="text-align:center;color:orange"><h3>Pending</h3><h2 id="st-pend">0</h2></div>
        </div>

        <div class="card">
            <h3>üîî ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</h3>
            <div id="req-list">Loading...</div>
        </div>

        <div class="card" style="border:1px solid #059669">
            <h3>üìã ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞</h3>
            <label>‡¶ï‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø?</label>
            <select id="t-target" class="inp">
                <option value="free">Free User</option>
                <option value="vip">VIP User</option>
            </select>
            
            <label>‡¶™‡ßç‡¶≤‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ:</label>
            <select id="t-type" class="inp">
                <option value="telegram">Telegram</option>
                <option value="youtube">YouTube</option>
                <option value="facebook">Facebook</option>
            </select>

            <input id="t-title" class="inp" placeholder="‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ (‡¶Ø‡ßá‡¶Æ‡¶®: Join Group)">
            <input id="t-reward" type="number" class="inp" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ (Reward)">
            <input id="t-link" class="inp" placeholder="‡¶≤‡¶ø‡¶Ç‡¶ï">
            <button class="btn" onclick="addTask()">‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶¶‡¶ø‡¶®</button>
            
            <div id="task-list" style="margin-top:15px"></div>
        </div>

        <div class="card">
            <h3>üíé VIP ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶®</h3>
            <input id="v-name" class="inp" placeholder="‡¶®‡¶æ‡¶Æ (Silver/Gold)">
            <input id="v-price" type="number" class="inp" placeholder="‡¶¶‡¶æ‡¶Æ">
            <input id="v-daily" type="number" class="inp" placeholder="‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶Ü‡ßü">
            <input id="v-valid" type="number" class="inp" placeholder="‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ (‡¶¶‡¶ø‡¶®)">
            <button class="btn" style="background:#f59e0b" onclick="addVip()">‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶® ‡¶è‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <div id="vip-list" style="margin-top:15px"></div>
        </div>

        <div class="card">
            <h3>‚öôÔ∏è ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</h3>
            <input id="c-bkash" class="inp" placeholder="‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞">
            <input id="c-nagad" class="inp" placeholder="‡¶®‡¶ó‡¶¶ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞">
            <input id="c-notice" class="inp" placeholder="‡¶®‡ßã‡¶ü‡¶ø‡¶∂...">
            <label><input type="checkbox" id="c-maint"> ‡¶Æ‡ßá‡¶á‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶Æ‡ßã‡¶°</label>
            <br><br>
            <button class="btn" onclick="saveConf()">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyDgI-d8iwWr40tmknbY6jhH0oRb2Tvg4d0", authDomain: "takar-gach-a1d84.firebaseapp.com", databaseURL: "https://takar-gach-a1d84-default-rtdb.firebaseio.com", projectId: "takar-gach-a1d84", storageBucket: "takar-gach-a1d84.firebasestorage.app", messagingSenderId: "637802367074", appId: "1:637802367074:web:2e7f6c0670ec47f3a1693b", measurementId: "G-0QL9LB7BSK" };
        firebase.initializeApp(firebaseConfig); const db=firebase.database();

        function auth(){
            if(document.getElementById('u').value==='JIHAD' && document.getElementById('p').value==='198373ZA'){
                document.getElementById('login').style.display='none'; document.getElementById('panel').style.display='block'; init();
            } else alert('Wrong!');
        }

        function init(){
            // USERS & REQUESTS
            db.ref('users').on('value',s=>{
                const u=s.val()||{}; document.getElementById('st-users').innerText=Object.keys(u).length;
                let p=0; const l=document.getElementById('req-list'); l.innerHTML='';
                Object.keys(u).forEach(k=>{
                    if(u[k].history) Object.keys(u[k].history).forEach(h=>{
                        const d=u[k].history[h];
                        if(d.status==='Pending'){
                            p++;
                            l.innerHTML+=`<div class="row">
                                <div><b>${u[k].name}</b><br><small>${d.type} (${d.amount})</small><br><small style="color:blue">${d.proof||''}</small></div>
                                <div>
                                    <button onclick="upd('${k}','${h}','Success','${d.type}')" style="background:#059669;color:white;border:none;padding:5px 10px;border-radius:5px">‚úî</button> 
                                    <button onclick="upd('${k}','${h}','Rejected','${d.type}')" style="background:#ef4444;color:white;border:none;padding:5px 10px;border-radius:5px">‚úò</button>
                                </div>
                            </div>`;
                        }
                    });
                });
                document.getElementById('st-pend').innerText=p;
                if(p===0) l.innerHTML='<p style="text-align:center;color:#999">No Requests</p>';
            });

            // LOAD DATA
            db.ref('settings').on('value',s=>{
                const d=s.val()||{};
                // Config
                if(d.config){ document.getElementById('c-bkash').value=d.config.bkash||''; document.getElementById('c-nagad').value=d.config.nagad||''; document.getElementById('c-maint').checked=d.config.maint||false; }
                document.getElementById('c-notice').value=d.notice||'';
                
                // Tasks
                const tl=document.getElementById('task-list'); tl.innerHTML='';
                if(d.tasks) Object.keys(d.tasks).forEach(k=>{
                    const t = d.tasks[k];
                    tl.innerHTML+=`<div class="row"><div><span style="background:${t.target=='vip'?'#f59e0b':'#eee'};padding:2px 5px;font-size:10px;border-radius:3px">${t.target.toUpperCase()}</span> <b>${t.title}</b><br><small>${t.reward} Tk</small></div><span onclick="db.ref('settings/tasks/${k}').remove()" style="color:red;cursor:pointer">üóë</span></div>`;
                });

                // VIP
                const vl=document.getElementById('vip-list'); vl.innerHTML='';
                if(d.vipPlans) Object.keys(d.vipPlans).forEach(k=>vl.innerHTML+=`<div class="row">${d.vipPlans[k].name} <span onclick="db.ref('settings/vipPlans/${k}').remove()" style="color:red;cursor:pointer">üóë</span></div>`);
            });
        }

        function addTask(){
            db.ref('settings/tasks').push({
                target: document.getElementById('t-target').value,
                type: document.getElementById('t-type').value,
                title: document.getElementById('t-title').value,
                reward: parseInt(document.getElementById('t-reward').value),
                link: document.getElementById('t-link').value
            });
            alert('Task Added');
        }
        function addVip(){
            db.ref('settings/vipPlans').push({
                name: document.getElementById('v-name').value,
                price: parseInt(document.getElementById('v-price').value),
                dailyIncome: parseInt(document.getElementById('v-daily').value),
                validity: parseInt(document.getElementById('v-valid').value)
            });
            alert('Plan Added');
        }
        function saveConf(){ db.ref('settings/config').update({bkash:document.getElementById('c-bkash').value,nagad:document.getElementById('c-nagad').value,maint:document.getElementById('c-maint').checked}); db.ref('settings/notice').set(document.getElementById('c-notice').value); alert('Saved'); }
        
        function upd(u,k,s,t){ 
            if(!confirm('Confirm?'))return;
            const up={}; up[`users/${u}/history/${k}/status`]=s;
            if(s==='Success' && t.includes('Buy')){ up[`users/${u}/isVip`]=true; up[`users/${u}/currentPlan`]=t.replace('Buy ',''); }
            db.ref().update(up);
        }
    </script>
</body>
</html>

